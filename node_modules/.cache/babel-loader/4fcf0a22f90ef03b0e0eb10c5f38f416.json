{"ast":null,"code":"import _slicedToArray from \"/home/turiya/Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"/home/turiya/Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/turiya/Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/turiya/Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/turiya/Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/turiya/Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/turiya/Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/src/components/ArticleView.jsx\";\nimport React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport CommentsSection from './CommentsSection';\nimport SideBar from './SideBar';\nimport * as api from '../api';\nimport CommentAdd from './CommentAdd';\n\nvar ArticleView =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ArticleView, _Component);\n\n  function ArticleView() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ArticleView);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ArticleView)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      article: null,\n      comments: [],\n      fakeVotes: 0\n    };\n\n    _this.handleAddComment = function (newComment) {\n      return _this.setState({\n        comments: _this.state.comments.concat(newComment)\n      });\n    };\n\n    _this.handleVote = function (voteDir) {\n      var voteValue = voteDir === 'up' ? 1 : -1;\n\n      _this.setState({\n        voteValueThisRefresh: _this.state.voteValueThisRefresh + voteValue\n      });\n\n      if (_this.props.loggedInUser) {\n        var article_id = _this.state.article._id;\n        return api.voteArticle(voteDir, article_id).then(function () {\n          var fakeVotes = _this.state.fakeVotes;\n          var newFakeVotes = voteDir === 'up' ? fakeVotes + 1 : fakeVotes - 1;\n\n          _this.setState({\n            fakeVotes: newFakeVotes\n          });\n        });\n      } else {\n        return console.log(\"You must be logged in to vote!\");\n      }\n    };\n\n    _this.handleDelete = function (article_id) {\n      return api.deleteArticle(article_id).then(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            data = _ref2[0],\n            status = _ref2[1];\n\n        if (/^2+/gm.test(status)) {\n          console.log('Article successfully deleted');\n          return React.createElement(Redirect, {\n            to: \"/\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 78\n            },\n            __self: this\n          });\n        } else {\n          return React.createElement(Redirect, {\n            to: \"/\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 82\n            },\n            __self: this\n          });\n        }\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(ArticleView, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      if (!this.state.article) return null;else {\n        var _this$state$article = this.state.article,\n            title = _this$state$article.title,\n            created_by = _this$state$article.created_by,\n            created_at = _this$state$article.created_at,\n            body = _this$state$article.body,\n            _id = _this$state$article._id;\n        var date = moment(created_at).format(\"Do MMMM YYYY\");\n        var loggedInUser = this.props.loggedInUser;\n        var ownArticle;\n\n        if (loggedInUser) {\n          ownArticle = loggedInUser.username === created_by.username ? true : false;\n        }\n\n        return React.createElement(\"div\", {\n          className: \"article_container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 30\n          },\n          __self: this\n        }, React.createElement(SideBar, {\n          handleVote: this.handleVote,\n          loggedInUser: this.props.loggedInUser,\n          fakeVotes: this.state.fakeVotes,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 31\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          className: \"article\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 32\n          },\n          __self: this\n        }, React.createElement(\"h2\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 33\n          },\n          __self: this\n        }, title), React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 34\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          id: \"article_delete_button\",\n          onClick: function onClick() {\n            return _this2.handleDelete(_id);\n          },\n          hidden: ownArticle ? false : true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 34\n          },\n          __self: this\n        }, \"Delete\")), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 34\n          },\n          __self: this\n        }), React.createElement(\"span\", {\n          className: \"by_line\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 35\n          },\n          __self: this\n        }, \"by \".concat(created_by.name)), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 35\n          },\n          __self: this\n        }), React.createElement(\"span\", {\n          className: \"article_date\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 36\n          },\n          __self: this\n        }, date), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 37\n          },\n          __self: this\n        }, body), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 37\n          },\n          __self: this\n        }), React.createElement(CommentAdd, {\n          loggedInUser: this.props.loggedInUser,\n          article_id: this.state.article._id,\n          handleAddComment: this.handleAddComment,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 38\n          },\n          __self: this\n        }), React.createElement(CommentsSection, {\n          loggedInUser: this.props.loggedInUser,\n          handleVotes: function handleVotes() {\n            _this2.handleVotes();\n          },\n          comments: this.state.comments,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 39\n          },\n          __self: this\n        })));\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this3 = this;\n\n      var article_id = this.props.match.params.article_id;\n      return api.fetchSingleArticleAndComments(article_id).then(function (_ref3) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n            article = _ref4[0],\n            comments = _ref4[1];\n\n        if (!article) {\n          console.log('Article does not exist');\n          return React.createElement(Redirect, {\n            to: \"/\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 95\n            },\n            __self: this\n          });\n        } else if (article.hasOwnProperty('title')) {\n          return _this3.setState({\n            article: article,\n            comments: comments,\n            fakeVotes: article.votes\n          });\n        } else {\n          return React.createElement(Redirect, {\n            to: \"/\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 103\n            },\n            __self: this\n          });\n        }\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this4 = this;\n\n      var article_id = this.props.match.params.article_id;\n\n      if (this.state.newComments !== prevState.newComments) {\n        return api.fetchSingleArticleAndComments(article_id).then(function (_ref5) {\n          var _ref6 = _slicedToArray(_ref5, 2),\n              article = _ref6[0],\n              comments = _ref6[1];\n\n          if (!article) {\n            console.log('Article does not exist');\n            return React.createElement(Redirect, {\n              to: \"/\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 117\n              },\n              __self: this\n            });\n          } else if (article.hasOwnProperty('title')) {\n            return _this4.setState({\n              article: article,\n              comments: comments,\n              fakeVotes: article.votes\n            });\n          }\n        });\n      } else if (this.props.loggedInUser) {\n        return api.fetchSingleArticleAndComments(article_id).then(function (_ref7) {\n          var _ref8 = _slicedToArray(_ref7, 2),\n              article = _ref8[0],\n              comments = _ref8[1];\n\n          if (!article) {\n            console.log('Article does not exist');\n            return React.createElement(Redirect, {\n              to: \"/\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 131\n              },\n              __self: this\n            });\n          } else if (article.hasOwnProperty('title')) {\n            return _this4.setState({\n              article: article,\n              comments: comments,\n              fakeVotes: article.votes\n            });\n          }\n        });\n      }\n    }\n  }]);\n\n  return ArticleView;\n}(Component);\n\nexport { ArticleView as default };\nArticleView.propTypes = {\n  loggedInUser: PropTypes.object,\n  match: PropTypes.object.isRequired\n};","map":{"version":3,"sources":["/home/turiya/Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/src/components/ArticleView.jsx"],"names":["React","Component","Redirect","PropTypes","moment","CommentsSection","SideBar","api","CommentAdd","ArticleView","state","article","comments","fakeVotes","handleAddComment","newComment","setState","concat","handleVote","voteDir","voteValue","voteValueThisRefresh","props","loggedInUser","article_id","_id","voteArticle","then","newFakeVotes","console","log","handleDelete","deleteArticle","data","status","test","title","created_by","created_at","body","date","format","ownArticle","username","name","handleVotes","match","params","fetchSingleArticleAndComments","hasOwnProperty","votes","prevProps","prevState","newComments","propTypes","object","isRequired"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport CommentsSection from './CommentsSection';\nimport SideBar from './SideBar';\nimport * as api from '../api';\nimport CommentAdd from './CommentAdd';\n\n\nexport default class ArticleView extends Component {\n\n    state = {\n        article: null,\n        comments: [],\n        fakeVotes: 0,\n    }\n\n    render() {\n        if (!this.state.article) return null;\n        else {\n            const { title, created_by, created_at, body, _id } = this.state.article;\n            const date = moment(created_at).format(\"Do MMMM YYYY\");\n            const { loggedInUser } = this.props;\n            let ownArticle;\n            if (loggedInUser) {\n                ownArticle = loggedInUser.username === created_by.username ? true : false\n            }\n            return (\n                <div className=\"article_container\">\n                    <SideBar handleVote={this.handleVote} loggedInUser={this.props.loggedInUser} fakeVotes={this.state.fakeVotes} />\n                    <div className=\"article\">\n                        <h2>{title}</h2>\n                        <span><button id=\"article_delete_button\" onClick={() => this.handleDelete(_id)} hidden={ownArticle ? false : true}>Delete</button></span><br />\n                        <span className=\"by_line\">{`by ${created_by.name}`}</span><br />\n                        <span className=\"article_date\">{date}</span>\n                        <p>{body}</p><br />\n                        <CommentAdd loggedInUser={this.props.loggedInUser} article_id={this.state.article._id} handleAddComment={this.handleAddComment} />\n                        <CommentsSection loggedInUser={this.props.loggedInUser} handleVotes={() => { this.handleVotes() }} comments={this.state.comments} />\n                    </div>\n                </div >\n            )\n        }\n    }\n\n    handleAddComment = (newComment) => {\n        return this.setState({\n            comments: this.state.comments.concat(newComment)\n        })\n    }\n\n    handleVote = (voteDir) => {\n        const voteValue = voteDir === 'up' ? 1 : -1;\n        this.setState({\n            voteValueThisRefresh: this.state.voteValueThisRefresh + voteValue\n        })\n        if (this.props.loggedInUser) {\n            const article_id = this.state.article._id;\n            return api.voteArticle(voteDir, article_id)\n                .then(() => {\n                    const { fakeVotes } = this.state;\n                    let newFakeVotes = voteDir === 'up' ? fakeVotes + 1 : fakeVotes - 1;\n                    this.setState({\n                        fakeVotes: newFakeVotes\n                    })\n                })\n        } else {\n            return console.log(\"You must be logged in to vote!\");\n        } \n    }\n\n    handleDelete = (article_id) => {\n        return api.deleteArticle(article_id)\n            .then(([data, status]) => {\n                if (/^2+/gm.test(status)) {\n                    console.log('Article successfully deleted')\n                    return (\n                        <Redirect to='/' />\n                    )\n                } else {\n                    return (\n                        <Redirect to='/' />\n                    )\n                }\n            })\n    }\n\n    componentDidMount() {\n        const { article_id } = this.props.match.params;\n        return api.fetchSingleArticleAndComments(article_id)\n            .then(([article, comments]) => {\n                if (!article) {\n                    console.log('Article does not exist')\n                    return (\n                        <Redirect to='/' />\n                    )\n                } else if (article.hasOwnProperty('title')) {\n                    return this.setState({\n                        article, comments, fakeVotes: article.votes\n                    })\n                } else {\n                    return (\n                        <Redirect to='/' />\n                    )\n                }\n            })\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        const { article_id } = this.props.match.params;\n        if (this.state.newComments !== prevState.newComments) {\n            return api.fetchSingleArticleAndComments(article_id)\n                .then(([article, comments]) => {\n                    if (!article) {\n                        console.log('Article does not exist')\n                        return (\n                            <Redirect to='/' />\n                        )\n                    } else if (article.hasOwnProperty('title')) {\n                        return this.setState({\n                            article, comments, fakeVotes: article.votes\n                        })\n                    }\n                })\n        } else if (this.props.loggedInUser) {\n            return api.fetchSingleArticleAndComments(article_id)\n                .then(([article, comments]) => {\n                    if (!article) {\n                        console.log('Article does not exist')\n                        return (\n                            <Redirect to='/' />\n                        )\n                    } else if (article.hasOwnProperty('title')) {\n                        return this.setState({\n                            article, comments, fakeVotes: article.votes\n                        })\n                    }\n                })\n        }\n    }\n}\n\nArticleView.propTypes = {\n    loggedInUser: PropTypes.object,\n    match: PropTypes.object.isRequired,\n}\n\n"]},"metadata":{},"sourceType":"module"}