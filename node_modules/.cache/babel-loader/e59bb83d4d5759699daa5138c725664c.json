{"ast":null,"code":"import _slicedToArray from \"/home/turiya/Google Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"/home/turiya/Google Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/turiya/Google Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/turiya/Google Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/turiya/Google Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/turiya/Google Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/turiya/Google Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/src/components/ArticleView.jsx\";\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport CommentsSection from './CommentsSection';\nimport SideBar from './SideBar';\nimport * as api from '../api';\nimport CommentAdd from './CommentAdd';\n\nvar ArticleView =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ArticleView, _Component);\n\n  function ArticleView() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ArticleView);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ArticleView)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      article: null,\n      comments: [],\n      fakeVotes: 0\n    };\n\n    _this.handleAddComment = function (newComment) {\n      return _this.setState({\n        comments: _this.state.comments.concat(newComment)\n      });\n    };\n\n    _this.handleVote = function (voteDir) {\n      if (_this.props.loggedInUser) {\n        var article_id = _this.state.article._id;\n        return api.voteArticle(voteDir, article_id).then(function () {\n          var fakeVotes = _this.state.fakeVotes;\n          var newFakeVotes = voteDir === 'up' ? fakeVotes + 1 : fakeVotes - 1;\n\n          _this.setState({\n            fakeVotes: newFakeVotes\n          });\n        });\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(ArticleView, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      if (!this.state.article) return null;else {\n        var _this$state$article = this.state.article,\n            title = _this$state$article.title,\n            created_by = _this$state$article.created_by,\n            created_at = _this$state$article.created_at,\n            body = _this$state$article.body;\n        var date = moment(created_at).format(\"Do MMMM YYYY\");\n        return React.createElement(\"div\", {\n          className: \"article_container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 24\n          },\n          __self: this\n        }, React.createElement(SideBar, {\n          handleVote: this.handleVote,\n          loggedInUser: this.props.loggedInUser,\n          fakeVotes: this.state.fakeVotes,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 25\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          className: \"article\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 26\n          },\n          __self: this\n        }, React.createElement(\"h2\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 27\n          },\n          __self: this\n        }, title), React.createElement(\"span\", {\n          className: \"by_line\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 28\n          },\n          __self: this\n        }, \"by \".concat(created_by.name)), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 28\n          },\n          __self: this\n        }), React.createElement(\"span\", {\n          className: \"article_date\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 29\n          },\n          __self: this\n        }, date), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 30\n          },\n          __self: this\n        }, body), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 30\n          },\n          __self: this\n        }), React.createElement(CommentAdd, {\n          loggedInUser: this.props.loggedInUser,\n          article_id: this.state.article._id,\n          handleAddComment: this.handleAddComment,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 31\n          },\n          __self: this\n        }), React.createElement(CommentsSection, {\n          loggedInUser: this.props.loggedInUser,\n          handleVotes: function handleVotes() {\n            _this2.handleVotes();\n          },\n          comments: this.state.comments,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 32\n          },\n          __self: this\n        })));\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this3 = this;\n\n      var article_id = this.props.match.params.article_id;\n      return api.fetchSingleArticleAndComments(article_id).then(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            article = _ref2[0],\n            comments = _ref2[1];\n\n        if (article.hasOwnProperty('title')) {\n          return _this3.setState({\n            article: article,\n            comments: comments,\n            fakeVotes: article.votes\n          });\n        }\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this4 = this;\n\n      var article_id = this.props.match.params.article_id;\n\n      if (this.state.newComments !== prevState.newComments) {\n        return api.fetchSingleArticleAndComments(article_id).then(function (_ref3) {\n          var _ref4 = _slicedToArray(_ref3, 2),\n              article = _ref4[0],\n              comments = _ref4[1];\n\n          if (article.hasOwnProperty('title')) {\n            return _this4.setState({\n              article: article,\n              comments: comments,\n              fakeVotes: article.votes\n            });\n          }\n        });\n      } else if (this.props.loggedInUser) {\n        return api.fetchSingleArticleAndComments(article_id).then(function (_ref5) {\n          var _ref6 = _slicedToArray(_ref5, 2),\n              article = _ref6[0],\n              comments = _ref6[1];\n\n          if (article.hasOwnProperty('title')) {\n            return _this4.setState({\n              article: article,\n              comments: comments,\n              fakeVotes: article.votes\n            });\n          }\n        });\n      }\n    }\n  }]);\n\n  return ArticleView;\n}(Component);\n\nexport { ArticleView as default };\nArticleView.propTypes = {\n  loggedInUser: PropTypes.object,\n  match: PropTypes.object.isRequired\n};","map":{"version":3,"sources":["/home/turiya/Google Drive/Coding/Northcoders 12-Week Course/nc-news/nc-news-frontend/src/components/ArticleView.jsx"],"names":["React","Component","PropTypes","moment","CommentsSection","SideBar","api","CommentAdd","ArticleView","state","article","comments","fakeVotes","handleAddComment","newComment","setState","concat","handleVote","voteDir","props","loggedInUser","article_id","_id","voteArticle","then","newFakeVotes","title","created_by","created_at","body","date","format","name","handleVotes","match","params","fetchSingleArticleAndComments","hasOwnProperty","votes","prevProps","prevState","newComments","propTypes","object","isRequired"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport CommentsSection from './CommentsSection';\nimport SideBar from './SideBar';\nimport * as api from '../api';\nimport CommentAdd from './CommentAdd';\n\n\nexport default class ArticleView extends Component {\n\n    state = {\n        article: null,\n        comments: [],\n        fakeVotes: 0,\n    }\n\n    render() {\n        if (!this.state.article) return null;\n        else {\n            const { title, created_by, created_at, body } = this.state.article;\n            const date = moment(created_at).format(\"Do MMMM YYYY\");\n            return (\n                <div className=\"article_container\">\n                    <SideBar handleVote={this.handleVote} loggedInUser={this.props.loggedInUser} fakeVotes={this.state.fakeVotes} />\n                    <div className=\"article\">\n                        <h2>{title}</h2>\n                        <span className=\"by_line\">{`by ${created_by.name}`}</span><br />\n                        <span className=\"article_date\">{date}</span>\n                        <p>{body}</p><br />\n                        <CommentAdd loggedInUser={this.props.loggedInUser} article_id={this.state.article._id} handleAddComment={this.handleAddComment} />\n                        <CommentsSection loggedInUser={this.props.loggedInUser} handleVotes={() => { this.handleVotes() }} comments={this.state.comments} />\n                    </div>\n                </div >\n            )\n        }\n    }\n\n    handleAddComment = (newComment) => {\n        return this.setState({\n            comments: this.state.comments.concat(newComment)\n        })\n    }\n\n    handleVote = (voteDir) => {\n        if (this.props.loggedInUser) {\n            const article_id = this.state.article._id;\n            return api.voteArticle(voteDir, article_id)\n                .then(() => {\n                    const { fakeVotes } = this.state;\n                    let newFakeVotes = voteDir === 'up' ? fakeVotes + 1 : fakeVotes - 1;\n                    this.setState({\n                        fakeVotes: newFakeVotes\n                    })\n                })\n        }\n    }\n\n    componentDidMount() {\n        const { article_id } = this.props.match.params;\n        return api.fetchSingleArticleAndComments(article_id)\n            .then(([article, comments]) => {\n                if (article.hasOwnProperty('title')) {\n                    return this.setState({\n                        article, comments, fakeVotes: article.votes\n                    })\n                }\n            })\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        const { article_id } = this.props.match.params;\n        if (this.state.newComments !== prevState.newComments) {\n            return api.fetchSingleArticleAndComments(article_id)\n                .then(([article, comments]) => {\n                    if (article.hasOwnProperty('title')) {\n                        return this.setState({\n                            article, comments, fakeVotes: article.votes\n                        })\n                    }\n                })\n        } else if (this.props.loggedInUser) {\n            return api.fetchSingleArticleAndComments(article_id)\n                .then(([article, comments]) => {\n                    if (article.hasOwnProperty('title')) {\n                        return this.setState({\n                            article, comments, fakeVotes: article.votes\n                        })\n                    }\n                })\n        }\n    }\n}\n\nArticleView.propTypes = {\n    loggedInUser: PropTypes.object,\n    match: PropTypes.object.isRequired\n}\n\n"]},"metadata":{},"sourceType":"module"}